<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<!--//////////////////////////////////////立交//////////////////////////////////////////-->
    <feature name="RD_GSC">
        <!--立交关系提取规则：
            a)	根据RD_LINK关联立交关系提取立交信息；
            b)	根据RW_LINK关联立交关系提取立交信息；
            c)	根据AD_LINK关联立交关系提取立交信息；
            d)	根据ZONE_LINK关联立交关系提取立交信息；
            e)	根据CMG_BUILDLINK提取立交关系
        -->
        <step value="40">
            <!--道路Link立交关系-->
            <sql id="exp-rd-RD_GSC-4.1">
                <![CDATA[
                        INSERT /*+ append */
                        INTO TEMP_RD_GSC
                          (PID)
                          (SELECT CN.PID
                             FROM TEMP_FILTER_RD_LINK N, RD_GSC_LINK CN
                            WHERE (N.PID = CN.LINK_PID AND CN.TABLE_NAME = 'RD_LINK'));
                        ]]></sql>
            <!--铁路Link立交关系-->
            <sql id="exp-rd-RD_GSC-4.2">
                <![CDATA[
                        INSERT /*+ append */
                        INTO TEMP_RD_GSC
                          (PID)
                          (SELECT CN.PID
                             FROM TEMP_FILTER_RW_LINK N, RD_GSC_LINK CN
                            WHERE (N.PID = CN.LINK_PID AND CN.TABLE_NAME = 'RW_LINK'));
                        ]]></sql>

            <!--ad Link立交关系-->
            <sql id="exp-rd-RD_GSC-4.3">
                <![CDATA[
                        INSERT /*+ append */
                        INTO TEMP_RD_GSC
                          (PID)
                          (SELECT CN.PID
                             FROM TEMP_AD_LINK N, RD_GSC_LINK CN
                            WHERE (N.PID = CN.LINK_PID AND CN.TABLE_NAME = 'AD_LINK'));
                        ]]></sql>

            <!--ZONE Link立交关系-->
            <sql id="exp-rd-RD_GSC-4.4">
                <![CDATA[
                        INSERT /*+ append */
                        INTO TEMP_RD_GSC
                          (PID)
                          (SELECT CN.PID
                             FROM TEMP_ZONE_LINK N, RD_GSC_LINK CN
                            WHERE (N.PID = CN.LINK_PID AND CN.TABLE_NAME = 'ZONE_LINK'));
                        ]]></sql>

            <!--CM_BUILDLINK立交关系-->
            <sql id="exp-rd-RD_GSC-4.5">
                <![CDATA[
                        INSERT /*+ append */
                        INTO TEMP_RD_GSC
                          (PID)
                          (SELECT CN.PID
                             FROM TEMP_CMG_BUILDLINK N, RD_GSC_LINK CN
                            WHERE (N.PID = CN.LINK_PID
                            		AND CN.TABLE_NAME = 'CMG_BUILDLINK'));
                        ]]></sql>
        </step>
        
        <step value="43">
            <!--TEMP_RD_GSC去重-->
            <sql id="exp-rd-RD_GSC-5.1">
                <![CDATA[
                        DELETE FROM TEMP_RD_GSC A
                         WHERE A.ROWID !=
                               (SELECT MAX(B.ROWID) FROM TEMP_RD_GSC B WHERE A.PID = B.PID);
                        ]]></sql>
        </step>
        
        <step value="100">
            <sql><![CDATA[SELECT P.* FROM RD_GSC P,TEMP_RD_GSC T WHERE P.PID=T.PID; ]]></sql>
            <sql><![CDATA[SELECT P.* FROM RD_GSC_LINK P,TEMP_RD_GSC T WHERE P.PID=T.PID; ]]></sql>
        </step>

        <step value="101">
        	<sql><![CDATA[DELETE FROM RD_GSC P WHERE P.PID IN (SELECT T.PID FROM TEMP_RD_GSC T ); ]]></sql>
        	<sql><![CDATA[DELETE FROM RD_GSC_LINK P WHERE P.PID IN (SELECT T.PID FROM TEMP_RD_GSC T ); ]]></sql>
        </step>

        <step value="102">
            <!--查找重复信息：-->
            <sql><![CDATA[
					INSERT /*+ append */ INTO TEMP_RD_GSC
					  SELECT PID
					    FROM RD_GSC A
					   WHERE A.ROWID !=
					         (SELECT MAX(B.ROWID) FROM RD_GSC  B WHERE A.PID = B.PID);
				]]></sql>
        </step>

    </feature>
</sqls>