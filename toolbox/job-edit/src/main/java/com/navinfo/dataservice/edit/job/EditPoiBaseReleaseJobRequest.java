package com.navinfo.dataservice.edit.job;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import net.sf.json.JSONArray;

import com.navinfo.dataservice.jobframework.exception.JobCreateException;
import com.navinfo.dataservice.jobframework.exception.JobException;
import com.navinfo.dataservice.jobframework.runjob.AbstractJobRequest;
import com.navinfo.dataservice.jobframework.runjob.JobCreateStrategy;

public class EditPoiBaseReleaseJobRequest extends AbstractJobRequest {
	private List<Integer> gridIds;
	private int targetDbId;
	private List<String> checkRules;
	private List<String> batchRules;


	@Override
	public String getJobType() {
		return "editPoiBaseRelease";
	}

	@Override
	public void validate() throws JobException {
		// TODO Auto-generated method stub
		
	}

	public List<Integer> getGridIds() {
		return gridIds;
	}

	public void setGridIds(List<Integer> gridIds) {
		this.gridIds = gridIds;
	}

	public int getTargetDbId() {
		return targetDbId;
	}

	public void setTargetDbId(int targetDbId) {
		this.targetDbId = targetDbId;
	}

	public List<String> getCheckRules() {
		return checkRules;
	}

	public void setCheckRules(List<String> checkRules) {
		this.checkRules = checkRules;
	}

	public List<String> getBatchRules() {
		return batchRules;
	}

	public void setBatchRules(List<String> batchRules) {
		this.batchRules = batchRules;
	}

	@Override
	public void defineSubJobRequests() throws JobCreateException {
		subJobRequests = new HashMap<String,AbstractJobRequest>();
		//validation
		List<String> checkRule=new ArrayList<String>();
		String rulestr = "COM60323,COM20713,COM20712,COM20714,COM20715,COM60313,COM300073,COM20560,COM20348,COM20561,COM20349,COM20562,COM60139,COM20563,COM60138,COM20564,COM20565,COM60137,COM20566,COM60136,COM60135,COM20567,COM20134,COM20133,COM20132,COM20131,COM20136,COM20135,COM60143,COM20559,CHR63469,COM20332,COM20557,COM60145,COM20330,COM20558,COM60144,COM20130,CHR63465,COM20336,COM60141,COM20333,COM20551,COM20338,COM60147,COM20555,COM20556,COM60146,COM60149,COM20553,COM20554,COM60148,CHR61103,COM20169,COM20168,COM20165,COM20167,COM20166,COM60152,COM60151,COM20162,COM60150,COM20369,COM20163,COM20362,COM60155,COM20363,CHR61107,COM20364,COM60154,COM60153,COM20543,COM20544,COM20350,COM60160,COM20358,COM60163,COM20355,COM20353,COM60164,COM20352,COM60169,COM60168,COM20359,COM60179,COM60175,COM20181,COM60176,COM60177,COM60178,COM60171,COM60172,COM60174,COM20182,COM20188,COM20186,COM20187,COM70001,COM70003,COM70002,COM70005,COM70004,COM70007,COM70006,COM70009,COM70008,CHR73051,CHR73050,CHR73055,CHR73054,CHR73053,CHR73052,COM20709,CHR73058,COM20708,COM20170,COM60186,CHR73057,COM60187,CHR73056,COM60184,COM20172,COM20174,COM60183,COM20173,COM20177,COM20179,COM60193,COM60194,COM60195,COM60196,CHR60019,CHR60018,COM60198,COM60199,CHR60014,COM20707,CHR60017,CHR60010,CHR60011,COM20703,COM60192,CHR60012,COM60191,CHR60013,CHR73070,COM20190,CHR60009,COM20192,COM20191,CHR60007,CHR60006,CHR60003,CHR60004,CHR60001,CHR60002,CHR71091,CHR71041,CHR71049,CHR71046,CHR71045,CHR71030,CHR71037,CHR71036,CHR71033,CHR71032,CHR71034,CHR63002,CHR71051,CHR71050,CHR61094,CHR61093,CHR61092,CHR61091,COM400018,COM400017,COM400016,COM400015,COM400014,COM400023,COM400024,COM400021,COM400022,COM70010,COM400020,COM70011,COM70012,COM70013,COM70014,COM70015,COM70016,COM70017,COM70018,COM70019,COM400029,COM400025,COM400028,COM400027,COM400032,COM400034,COM400035,COM70022,COM70023,COM400030,COM70020,COM400031,COM70021,COM70024,CHR63132,COM70031,COM70032,COM70033,COM70034,COM400001,COM400002,COM70035,CHR61083,COM400004,COM400003,COM400006,COM400008,COM400007,COM400009,COM400010,COM400011,COM400013,COM01001,COM400058,COM400059,CHR63648,CHR63649,COM400060,COM70058,COM70057,COM70059,COM400068,COM400067,COM400066,COM01003,COM400065,COM400064,COM70054,COM400063,COM400062,COM70056,COM400061,COM70055,COM400069,COM70069,COM400071,COM400070,COM70068,COM400077,COM70062,COM70061,COM400079,COM70060,COM400078,COM400073,COM70067,COM400072,COM70065,COM70064,COM400039,COM400036,COM400037,COM70070,COM10010,COM10013,COM10014,COM10011,COM10012,COM10015,CHR63625,COM70076,COM400042,COM400041,COM70075,COM400040,COM400046,COM70072,COM400045,COM70071,COM400044,COM70074,COM400043,COM400047,COM400048,COM70081,COM400049,COM400051,COM70088,COM400050,COM70087,COM400053,COM400052,COM70086,COM400055,COM70085,COM400054,COM70084,COM400057,COM70083,COM400056,COM60319,COM60321,COM60320,COM20204,COM20203,COM20202,COM10009,COM20464,COM10007,COM20208,CHR70079,COM20463,COM10006,COM20207,COM10005,COM20206,COM10004,COM20205,COM20468,COM10003,COM10002,COM60318,COM60312,COM20460,CHR72041,COM60303,COM60306,COM60305,COM60304,CHR63650,CHR63651,COM20488,COM20484,COM20483,COM20481,COM20482,COM20690,COM20691,COM20693,COM20692,COM20694,CHR63398,CHR63389,COM20008,COM20009,COM60273,COM20281,COM20003,COM20282,COM20283,COM20005,COM20006,COM20001,COM60274,COM20280,COM20002,COM20289,COM20286,COM20285,COM20288,COM20287,COM60289,GLM01376,COM20272,COM20273,COM60284,COM20270,COM60283,COM20271,COM60286,COM60285,COM60288,COM60287,COM20279,COM20278,COM20277,COM60001,COM20275,COM60002,COM20274,COM60003,COM60005,COM60006,COM60007,COM60259,COM60258,COM20687,COM60257,COM20688,COM60256,COM20689,COM60255,COM60254,COM60253,COM60252,COM60251,COM60250,COM20260,COM20261,COM20264,COM20404,COM20263,COM20403,COM20266,COM20406,COM20265,COM20405,COM20408,COM20268,COM20267,COM20407,COM20409,COM20269,COM20402,COM20401,COM20674,CHR63348,COM20250,CHR63346,COM20254,COM20259,COM20258,COM20628,GLM80007,COM20048,COM20627,GLM80005,COM20629,COM20624,COM20623,COM20626,GLM80001,COM60230,COM20625,COM20620,COM60237,COM20622,COM20621,COM60238,COM60239,COM20421,COM20420,COM20040,COM60030,COM20041,COM20241,COM20426,COM20243,COM20244,COM20619,COM20039,COM20618,COM20038,COM20617,COM20037,COM20035,COM20034,COM60242,COM60243,COM20033,COM60244,COM20612,COM20032,COM20611,COM60249,COM20412,COM20413,COM20410,COM60049,COM20411,COM20239,COM20030,COM20236,COM20031,COM20237,COM20418,COM20419,COM20235,COM20416,COM20232,COM20417,COM20233,COM20414,COM20230,COM20415,COM20231,COM60210,COM60219,COM60216,COM60217,COM20642,COM60214,COM60215,COM60212,COM60213,COM20227,COM20228,COM20441,COM20229,COM20442,COM20444,COM20445,COM60209,COM20447,COM20220,COM20221,COM20222,COM20223,COM20224,COM20225,COM20226,COM20637,COM20636,COM60220,COM20635,COM20634,COM60222,COM20638,COM60228,COM20633,COM20632,COM20631,COM20630,CHR63581,COM20218,COM20219,COM20216,COM60026,COM60025,COM60027,COM20211,COM20212,COM20213,COM60072,COM20085,COM60073,COM60076,COM60077,COM20081,COM20080,COM20089,COM60071,COM60070,COM60083,COM60084,CHR61019,COM60087,COM60088,COM20070,CHR61010,CHR61018,CHR61017,CHR61012,CHR61011,COM20077,CHR61014,CHR61013,COM20079,COM60054,COM60055,COM400098,COM400099,CHR61009,COM400096,COM60050,COM400097,COM60051,COM400094,COM20062,COM60052,COM400095,COM20061,COM60053,COM400092,COM400093,COM400090,COM400091,COM20067,CHR61003,COM20068,CHR61002,CHR61001,COM20066,COM20607,CHR61007,CHR61006,CHR61004,COM400087,COM60067,COM400088,COM60068,COM400089,COM60065,COM60066,COM400083,COM20051,COM60063,COM60064,COM400084,COM400085,COM20053,COM400086,COM20052,COM400080,COM400081,COM400082,COM60069,COM20054,COM20057,COM20059,COM70104,CHR61062,CHR61061,CHR63129,COM60099,COM60098,COM60291,COM60290,COM60095,COM60094,COM60097,COM60096,COM60296,COM60092,COM60093,COM60292,COM60293,COM60294,COM60295,COM70113,COM70112,COM20296,COM20090,COM20091,COM20297,COM20092,COM20298,COM20299,COM20093,COM20099,COM20291,COM20290,COM20293,COM20295,COM20294,COM400109,COM400108,COM400107,COM400106,COM400105,COM400104,COM400103,COM400102,COM400111,COM400112,COM400110,COM400100,CHR63710,COM400101,COM50001,COM50002,COM50003,COM50008,COM50009,COM50004,COM50005,COM50007,COM300059,COM11010,COM11011,COM11013,COM11012,COM11015,COM11014,COM300065,COM300064,CHR70109,COM300067,COM300066,COM300060,CHR70108,CHR70107,COM300062,CHR70112,CHR70113,CHR70110,COM300049,CHR70111,COM300046,COM300047,CHR73047,COM11007,CHR73048,COM11006,CHR73045,COM11005,CHR73046,COM11004,COM11003,COM11002,CHR73049,CHR73040,COM300054,COM300053,COM300052,CHR73043,CHR73044,CHR73041,COM11009,CHR73042,COM300040,COM300041,COM300044,COM300038,COM20309,COM20300,COM300025,COM300024,COM300027,COM300026,COM300022,COM20316,COM300023,COM20571,COM20576,COM20319,COM20578,COM80013,COM20579,COM20310,COM50024,COM50023,COM20570,COM20582,COM20321,COM20323,COM50016,COM50015,COM50018,COM50017,COM50019,COM300007,COM50010,COM300003,COM50012,COM20580,COM20581,COM50011,COM300002,COM50014,COM300004,COM50013,COM400115,COM400113,COM400114,COM60208,COM60207,COM60206,COM60205,COM60201,CHR63272,CHR63419,COM20381,CHR71001,COM20105,COM20106,COM20107,GLM91020,COM20108,GLM91021,COM20109,GLM91023,GLM91022,GLM91024,COM20385,CHR63415,COM20387,COM20386,COM20389,COM20388,CHR63428,CHR60061,CHR60062,COM60106,COM60108,COM60109,COM60102,COM60103,COM20510,COM60104,COM20376,COM20375,COM60100,COM20373,CHR63423,COM20378,COM20124,COM20125,COM20126,COM20127,CHR71024,COM20120,CHR71025,COM20121,CHR71026,COM20122,CHR71027,CHR71028,COM20123,COM20128,COM20129,CHR60091,COM60115,COM60116,COM60113,COM60114,COM60117,COM60118,COM20507,COM60111,CHR63438,CHR63436,COM60110,COM20393,COM20394,COM20391,COM20392,CHR71014,CHR71015,CHR60083,COM20119,COM20117,COM20118,COM60124,COM60128,COM60129,CHR63441,COM20399,GLM91019,COM20398,COM60120,COM20397,COM20396,COM20395,COM60123,COM20143,COM20144,COM20568,COM60134,COM20569,COM20341,COM20342,COM20344,COM60130,COM20345,COM20346,COM20094,COM20095,COM20534,COM60038,COM60040,COM60041,COM60042,COM60043,COM60056,COM60057,COM20097,COM60080,COM20334,COM20367,COM300028,COM70080,COM60156,COM60245,COM60246,COM60058,COM20096,COM20511,GLM55094,CHR62074,CHR62073,GLM61018,CHR62072,CHR62071,CHR62070,CHR62079,CHR62078,CHR60069,GLM59029,CHR60024,GLM60293,CHR62063,CHR62066,CHR62065,CHR62060,CHR73020,CHR62068,CHR62067,CHR62069,GLM60049,CHR60050,CHR62051,CHR62050,CHR73038,CHR62055,CHR73039,CHR62054,CHR62053,CHR62052,CHR62059,CHR62058,CHR62057,CHR62056,CHR70002,CHR73032,GLM59002,GLM59044,GLM59006,GLM59007,CHR60045,CHR62042,CHR62041,CHR62044,CHR62043,CHR62081,GLM60414,CHR62045,CHR62048,GLM60415,CHR73001,CHR62047,GLM60237,CHR62049,CHR62024,CHR62080,CHR60074,CHR60073,CHR62077,CHR62076,CHR62075,GLM60455,GLM60039,GLM55029,GLM99003,GLM59056,GLM01420,GLM01421,GLM60273,GLM01424,GLM01423,GLM01422,GLM55129,GLM55130,GLM60225,GLM55036,GLM55103,GLM55092,GLM60228,,";
		for(String r:rulestr.split(",")){
			checkRule.add(r);
		}
//		checkRule.add("GLM01004");
		this.setCheckRules(checkRule);
		AbstractJobRequest validation = JobCreateStrategy.createJobRequest("gdbValidation", null);
		validation.setAttrValue("grids", gridIds);
		validation.setAttrValue("rules", JSONArray.fromObject(this.checkRules));
		validation.setAttrValue("targetDbId", targetDbId);
		validation.setAttrValue("timeOut", 300);
		subJobRequests.put("validation", validation);
		//batch
		List<String> batchRule=new ArrayList<String>();
//		batchRule.add("BATCH_TUNNELNAME");
//		batchRule.add("BATCH_SLE");
//		batchRule.add("BATCH_VECTOR_ATTR");
		batchRule.add("BATCH_LANE_PARKING_FLAG");
//		batchRule.add("MILEAGEPILE_NAMECODE");
		
		this.setBatchRules(batchRule);
		AbstractJobRequest batch = JobCreateStrategy.createJobRequest("gdbBatch", null);
		batch.setAttrValue("grids", gridIds);
		batch.setAttrValue("rules", JSONArray.fromObject(this.batchRules));
		batch.setAttrValue("targetDbId", targetDbId);
		subJobRequests.put("batch", batch);
	}

	@Override
	protected int myStepCount() throws JobException {
		return 1;
	}

}
