package com.navinfo.dataservice.engine.man;

import java.sql.Connection;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import org.apache.commons.dbutils.DbUtils;
import org.apache.commons.lang.StringUtils;
import org.junit.Before;
import org.junit.Test;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import com.navinfo.dataservice.api.man.model.Block;
import com.navinfo.dataservice.bizcommons.datasource.DBConnector;
import com.navinfo.dataservice.commons.database.DbConnectConfig;
import com.navinfo.dataservice.commons.fileConvert.ImportOracle;
import com.navinfo.dataservice.commons.fileConvert.LoadTab;
import com.navinfo.dataservice.commons.geom.GeoTranslator;
import com.navinfo.dataservice.commons.springmvc.ApplicationContextUtil;
import com.navinfo.dataservice.engine.man.block.BlockService;
import com.navinfo.dataservice.engine.man.subtask.SubtaskRefer;
import com.navinfo.dataservice.engine.man.subtask.SubtaskReferOperation;
import com.navinfo.dataservice.engine.man.subtask.SubtaskService;
import com.navinfo.navicommons.database.QueryRunner;
import com.vividsolutions.jts.geom.Geometry;

import net.sf.json.JSONObject;
import oracle.sql.STRUCT;

public class commonTest extends InitApplication {
	
	@Before
	public void init() {
		initContext();
	}
	
	@Test
	public void testInsertGeo() throws Exception {
		System.out.println("start"); 
		String wkt="POLYGON ((105.109658 29.581114, 105.309453 29.57779, 105.310766 29.57774, 105.313796 29.576669, 105.315327 29.576607, 105.316107 29.576772, 105.317217 29.577453, 105.317676 29.578181, 105.317611 29.57965, 105.317408 29.580681, 105.316605 29.584834, 105.315764 29.587416, 105.314799 29.589046, 105.314111 29.595352, 105.313694 29.598503, 105.31374 29.600078, 105.314858 29.600619, 105.315577 29.600277, 105.316104 29.600107, 105.316633 29.600055, 105.317222 29.599944, 105.317688 29.600001, 105.318078 29.600063, 105.318477 29.600177, 105.318806 29.60041, 105.319128 29.600698, 105.319586 29.601218, 105.319847 29.601791, 105.320107 29.602307, 105.320298 29.602998, 105.320429 29.603514, 105.320429 29.604259, 105.320291 29.605175, 105.320482 29.606437, 105.320674 29.607699, 105.320804 29.608503, 105.321064 29.608964, 105.321324 29.609309, 105.321524 29.609423, 105.321853 29.60954, 105.322243 29.609599, 105.322641 29.609659, 105.32297 29.609548, 105.323299 29.609375, 105.323827 29.609091, 105.324355 29.608693, 105.324814 29.608409, 105.325343 29.607952, 105.32607 29.607613, 105.326728 29.607273, 105.327715 29.60682, 105.32884 29.606082, 105.329368 29.605681, 105.329567 29.605226, 105.329766 29.604768, 105.329835 29.604193, 105.329835 29.603677, 105.329773 29.603048, 105.329712 29.602531, 105.329582 29.602015, 105.329261 29.601325, 105.328733 29.600462, 105.328143 29.600001, 105.327753 29.599712, 105.327424 29.599538, 105.326835 29.599247, 105.325846 29.598785, 105.325127 29.598379, 105.324737 29.598091, 105.324538 29.597688, 105.324408 29.597457, 105.324347 29.596998, 105.324347 29.596713, 105.324416 29.596426, 105.324615 29.596198, 105.325074 29.59597, 105.325334 29.595917, 105.325732 29.595803, 105.326122 29.595806, 105.32678 29.595808, 105.327377 29.595984, 105.328166 29.596217, 105.329016 29.59645, 105.330133 29.596686, 105.33086 29.596805, 105.331319 29.596692, 105.331778 29.59658, 105.331847 29.596235, 105.331915 29.595952, 105.331915 29.595607, 105.331854 29.595148, 105.331854 29.594459, 105.331862 29.593828, 105.331932 29.593142, 105.33213 29.592684, 105.33239 29.592226, 105.332727 29.591828, 105.333148 29.591473, 105.333585 29.591257, 105.333914 29.59126, 105.334304 29.59132, 105.334633 29.591493, 105.334832 29.591667, 105.335092 29.591954, 105.335352 29.592298, 105.335681 29.592589, 105.335681 29.59276, 105.335673 29.593217, 105.335536 29.594537, 105.335406 29.595567, 105.335658 29.596428, 105.335858 29.597173, 105.336049 29.597805, 105.33631 29.598266, 105.336639 29.598727, 105.337427 29.599532, 105.337878 29.599937, 105.338476 29.600343, 105.339126 29.60069, 105.340113 29.601267, 105.341031 29.601902, 105.341621 29.602478, 105.34195 29.602881, 105.342141 29.603341, 105.342202 29.603685, 105.342202 29.60403, 105.342004 29.604371, 105.341805 29.604603, 105.341146 29.604998, 105.339891 29.605795, 105.336991 29.60704, 105.336593 29.607439, 105.336394 29.607841, 105.336394 29.60807, 105.336593 29.608302, 105.336853 29.608531, 105.337182 29.608648, 105.33758 29.60882, 105.33797 29.608879, 105.338231 29.608826, 105.338698 29.608883, 105.339157 29.608772, 105.339746 29.608658, 105.340275 29.608548, 105.341131 29.608382, 105.34192 29.608441, 105.342249 29.608559, 105.342708 29.608733, 105.343037 29.60902, 105.343229 29.609309, 105.343358 29.609825, 105.343428 29.610228, 105.343489 29.611032, 105.343481 29.612804, 105.343665 29.615043, 105.343925 29.616364, 105.344377 29.61757, 105.344767 29.618432, 105.345226 29.619348, 105.345877 29.620156, 105.346535 29.620848, 105.347254 29.621598, 105.348035 29.62246, 105.349221 29.623441, 105.35046 29.62448, 105.352037 29.625462, 105.353743 29.626502, 105.355189 29.62731, 105.356323 29.62792, 105.357026 29.628295, 105.354731 29.638958, 105.359511 29.640386, 105.377051 29.640541, 105.376803 29.641746, 105.376864 29.642343, 105.377576 29.643302, 105.378305 29.643764, 105.378604 29.643881, 105.380091 29.64447, 105.382472 29.645016, 105.383306 29.64549, 105.383963 29.645771, 105.384957 29.646194, 105.385951 29.646902, 105.387105 29.64761, 105.388099 29.648318, 105.389253 29.648739, 105.390246 29.649161, 105.390911 29.649584, 105.391407 29.650009, 105.391904 29.650295, 105.392233 29.650722, 105.392401 29.651149, 105.391801 29.653341, 105.390789 29.65807, 105.390728 29.65897, 105.390502 29.659883, 105.389643 29.661618, 105.388814 29.662434, 105.386544 29.663579, 105.38576 29.664149, 105.385558 29.664295, 105.385202 29.664776, 105.384615 29.666136, 105.384186 29.668886, 105.384278 29.670242, 105.384519 29.670911, 105.385371 29.672275, 105.3875 29.674675, 105.388884 29.676305, 105.389411 29.676546, 105.389701 29.676529, 105.39311 29.675058, 105.397743 29.672909, 105.400577 29.671606, 105.401092 29.671884, 105.406198 29.675258, 105.408393 29.677267, 105.408981 29.678556, 105.410302 29.680527, 105.411115 29.68142, 105.414672 29.684334, 105.41971 29.687974, 105.420656 29.688332, 105.421362 29.688395, 105.422739 29.688188, 105.423544 29.687859, 105.417035 29.717897, 105.403161 29.747586, 105.381447 29.796547, 105.367574 29.808006, 105.322937 29.81009, 105.282523 29.805923, 105.19687 29.826757, 105.157663 29.839779, 105.101566 29.8528, 105.088899 29.902282, 105.000834 29.973641, 104.967658 29.998642, 104.93733 29.946208, 104.886844 29.922673, 104.820463 29.906443, 104.786806 29.899139, 104.750344 29.929166, 104.703597 29.955946, 104.668069 29.947831, 104.651241 29.946208, 104.635347 29.950266, 104.600754 29.932412, 104.543723 29.933223, 104.530634 29.968931, 104.567097 29.990031, 104.542788 29.998146, 104.517545 30.00545, 104.508196 30.013565, 104.480148 30.010319, 104.46744 29.994865, 104.473603 29.96325, 104.498847 29.914558, 104.488562 29.839897, 104.495186 29.810718, 104.487627 29.794451, 104.462384 29.764992, 104.437609 29.751188, 104.413768 29.736166, 104.394134 29.745098, 104.384785 29.741038, 104.377773 29.741038, 104.371696 29.73373, 104.367021 29.73373, 104.361968 29.736807, 104.34692 29.73576, 104.332896 29.713023, 104.318405 29.696377, 104.299238 29.695971, 104.292226 29.692317, 104.278202 29.67161, 104.27119 29.657806, 104.267918 29.64522, 104.270804 29.627621, 104.275024 29.605122, 104.301279 29.58835, 104.323783 29.578533, 104.381876 29.597707, 104.391764 29.605531, 104.430678 29.594895, 104.503816 29.541717, 104.531523 29.493631, 104.549293 29.470949, 104.572266 29.453359, 104.578829 29.440269, 104.582691 29.429329, 104.602271 29.415725, 104.630402 29.412452, 104.659939 29.382181, 104.671408 29.367272, 104.677778 29.367491, 104.681885 29.370632, 104.685909 29.381518, 104.68901 29.384221, 104.694375 29.382906, 104.70326 29.371582, 104.712145 29.363619, 104.718097 29.363619, 104.721701 29.36435, 104.725613 29.36523, 104.72793 29.368394, 104.730863 29.371019, 104.732176 29.37425, 104.740243 29.38411, 104.744258 29.386971, 104.751824 29.389731, 104.742922 29.403493, 104.743625 29.419218, 104.753002 29.433717, 104.759097 29.446583, 104.775506 29.454344, 104.79392 29.453409, 104.825672 29.445358, 104.836973 29.440966, 104.849348 29.453731, 104.846806 29.465412, 104.849348 29.469252, 104.868735 29.467438, 104.885624 29.463768, 104.906736 29.45905, 104.907339 29.448564, 104.910355 29.440176, 104.919403 29.43703, 104.932673 29.439651, 104.941118 29.428641, 104.954388 29.421301, 104.985754 29.438078, 105.01531 29.441748, 105.032199 29.45171, 105.034613 29.464817, 105.047279 29.471633, 105.059343 29.453807, 105.075629 29.458001, 105.08528 29.441512, 105.065375 29.411278, 105.046978 29.388405, 105.04939 29.36711, 105.079248 29.334247, 105.134742 29.263526, 105.17033 29.243545, 105.194458 29.228297, 105.269856 29.192805, 105.291873 29.209894, 105.309667 29.25117, 105.339826 29.276934, 105.345859 29.285084, 105.358224 29.291394, 105.38024 29.292445, 105.407988 29.310849, 105.423308 29.315511, 105.422022 29.31673, 105.420786 29.318525, 105.420439 29.319429, 105.420435 29.320737, 105.42205 29.323262, 105.42284 29.325234, 105.423027 29.326242, 105.422969 29.327649, 105.422779 29.328496, 105.422336 29.330468, 105.42226 29.330675, 105.421196 29.333513, 105.420712 29.340664, 105.419636 29.34455, 105.419415 29.34691, 105.419407 29.351645, 105.419461 29.353651, 105.419869 29.354627, 105.421812 29.356728, 105.423311 29.35782, 105.426499 29.359778, 105.436921 29.366321, 105.437957 29.366882, 105.440091 29.367929, 105.441487 29.368943, 105.444707 29.372925, 105.445675 29.37416, 105.446067 29.375465, 105.445629 29.378269, 105.444978 29.382635, 105.444441 29.384803, 105.44374 29.38627, 105.443062 29.387241, 105.441461 29.389045, 105.440489 29.390565, 105.4398 29.392806, 105.439427 29.397325, 105.439697 29.400195, 105.439488 29.401073, 105.438618 29.402731, 105.437772 29.40372, 105.435787 29.405442, 105.434659 29.406915, 105.432115 29.413007, 105.431727 29.414048, 105.43072 29.416726, 105.429825 29.41763, 105.428978 29.417954, 105.428352 29.418021, 105.427192 29.417867, 105.425004 29.416245, 105.42254 29.415955, 105.421346 29.416091, 105.420453 29.416442, 105.418755 29.41756, 105.41737 29.418075, 105.416179 29.418072, 105.413775 29.417694, 105.41197 29.417532, 105.409833 29.418012, 105.409695 29.419153, 105.40923 29.4199, 105.40884 29.420299, 105.408443 29.420472, 105.408054 29.420642, 105.407198 29.42064, 105.407 29.421213, 105.406931 29.421785, 105.406992 29.422474, 105.407252 29.422991, 105.40752 29.423335, 105.408039 29.42391, 105.409672 29.425003, 105.41026 29.425692, 105.410062 29.425978, 105.409665 29.426207, 105.409009 29.426433, 105.408481 29.426662, 105.408481 29.426777, 105.408481 29.426947, 105.408611 29.42718, 105.40907 29.427411, 105.409459 29.427697, 105.410703 29.427986, 105.411031 29.428273, 105.411092 29.42856, 105.411092 29.428962, 105.410833 29.429306, 105.410505 29.42942, 105.410047 29.429417, 105.408864 29.42953, 105.408665 29.429815, 105.408597 29.430331, 105.408467 29.43056, 105.408268 29.430619, 105.408077 29.430731, 105.407749 29.430731, 105.407352 29.430672, 105.406703 29.430555, 105.406565 29.430784, 105.406436 29.431014, 105.406107 29.431416, 105.40545 29.431698, 105.404993 29.431698, 105.404465 29.43164, 105.402045 29.431115, 105.401387 29.431056, 105.401059 29.431229, 105.401059 29.4314, 105.401059 29.431801, 105.40112 29.432204, 105.401189 29.432832, 105.401052 29.433234, 105.400853 29.433633, 105.400463 29.433862, 105.399868 29.434262, 105.399211 29.43472, 105.398623 29.435289, 105.398424 29.435633, 105.398485 29.435748, 105.398615 29.435979, 105.398882 29.436152, 105.399142 29.436208, 105.399731 29.436269, 105.400448 29.436443, 105.400846 29.436672, 105.401166 29.437018, 105.401166 29.437132, 105.400968 29.437361, 105.40064 29.437647, 105.399784 29.438274, 105.399127 29.438732, 105.399127 29.438844, 105.399326 29.439191, 105.399455 29.439534, 105.399517 29.43988, 105.399517 29.440223, 105.399188 29.440566, 105.398791 29.440737, 105.398333 29.440907, 105.397676 29.441192, 105.397286 29.441477, 105.397018 29.441764, 105.397018 29.442508, 105.397011 29.442966, 105.397011 29.443426, 105.396943 29.443825, 105.396812 29.444169, 105.396484 29.444514, 105.396088 29.444799, 105.39556 29.445082, 105.394972 29.445252, 105.394712 29.445366, 105.394712 29.445481, 105.394773 29.445654, 105.394972 29.44571, 105.3953 29.445713, 105.395759 29.445713, 105.396416 29.445774, 105.396736 29.445774, 105.396874 29.445889, 105.396936 29.44612, 105.396936 29.446291, 105.396805 29.446519, 105.396469 29.446863, 105.395751 29.447262, 105.394696 29.447603, 105.394696 29.447832, 105.394696 29.448175, 105.394696 29.448462, 105.394628 29.448692, 105.394429 29.448921, 105.394101 29.449032, 105.393711 29.449146, 105.393122 29.449146, 105.392665 29.449258, 105.392359 29.449426, 105.391939 29.449657, 105.391343 29.450458, 105.390884 29.451086, 105.390686 29.451659, 105.385424 29.451991, 105.378593 29.450832, 105.373956 29.450042, 105.368667 29.448774, 105.366158 29.447745, 105.363572 29.445779, 105.360026 29.4437, 105.357457 29.443788, 105.353836 29.442186, 105.351082 29.442008, 105.349689 29.44209, 105.347654 29.442472, 105.34661 29.442932, 105.34478 29.444254, 105.343281 29.445065, 105.340598 29.445772, 105.339224 29.445968, 105.336373 29.446059, 105.334973 29.445858, 105.331938 29.444904, 105.330017 29.444271, 105.329102 29.444285, 105.32841 29.444635, 105.327242 29.445763, 105.32634 29.446595, 105.32308 29.454759, 105.326184 29.458472, 105.327637 29.459866, 105.330902 29.462298, 105.331686 29.462624, 105.333546 29.462847, 105.334771 29.463307, 105.335008 29.463672, 105.334839 29.46449, 105.332334 29.46663, 105.330149 29.468151, 105.329403 29.468315, 105.327688 29.46796, 105.326853 29.46792, 105.326475 29.468039, 105.325564 29.468589, 105.32416 29.470067, 105.322691 29.473894, 105.321508 29.475319, 105.320762 29.47592, 105.31984 29.476402, 105.317801 29.477005, 105.316319 29.477615, 105.315581 29.47812, 105.315421 29.478458, 105.315619 29.480315, 105.316148 29.483411, 105.315945 29.484091, 105.31467 29.485212, 105.312608 29.485495, 105.311246 29.486592, 105.310936 29.487296, 105.311205 29.490449, 105.310899 29.495573, 105.310482 29.497304, 105.309881 29.499792, 105.310004 29.500364, 105.310788 29.501424, 105.312598 29.502719, 105.313509 29.50311, 105.315479 29.503659, 105.316792 29.504404, 105.317247 29.505361, 105.317803 29.508008, 105.317645 29.5093, 105.317141 29.510467, 105.315595 29.512622, 105.310196 29.518141, 105.308206 29.521009, 105.307866 29.521917, 105.307648 29.52387, 105.307185 29.525291, 105.306382 29.526149, 105.305835 29.526418, 105.302162 29.527205, 105.299053 29.528119, 105.297526 29.528729, 105.296421 29.529471, 105.295786 29.529894, 105.295116 29.530647, 105.294443 29.531938, 105.294321 29.534978, 105.294086 29.546551, 105.290929 29.548476, 105.290861 29.549391, 105.290723 29.550424, 105.290326 29.551169, 105.290088 29.551733, 105.289997 29.551967, 105.289791 29.552656, 105.289859 29.553112, 105.289989 29.553343, 105.290181 29.553517, 105.290578 29.553748, 105.290969 29.553691, 105.291565 29.55335, 105.292023 29.553125, 105.292421 29.553069, 105.29262 29.553128, 105.292812 29.553243, 105.292881 29.553416, 105.292812 29.553586, 105.292812 29.553874, 105.292743 29.554275, 105.292743 29.554793, 105.292873 29.555077, 105.293064 29.555309, 105.293332 29.555365, 105.293592 29.555368, 105.293852 29.555371, 105.294318 29.555257, 105.294579 29.555316, 105.294708 29.555433, 105.294908 29.555604, 105.295038 29.555777, 105.295099 29.556235, 105.29503 29.556581, 105.29503 29.55681, 105.2949 29.557036, 105.294763 29.557267, 105.294434 29.558066, 105.294105 29.558524, 105.293837 29.559039, 105.293638 29.559554, 105.293439 29.560183, 105.293431 29.560812, 105.293493 29.561273, 105.293692 29.561675, 105.294801 29.562885, 105.29526 29.563516, 105.29552 29.563918, 105.29565 29.564377, 105.295712 29.564781, 105.295841 29.565125, 105.295841 29.565582, 105.295971 29.566044, 105.296163 29.566331, 105.296293 29.566558, 105.296561 29.566792, 105.296752 29.566965, 105.296951 29.567137, 105.296522 29.570517, 105.296787 29.571214, 105.297074 29.571502, 105.29868 29.572522, 105.308829 29.577629, 105.309453 29.57779, 105.109658 29.581114, 105.111906 29.573765, 105.108141 29.562033, 105.104219 29.556713, 105.09716 29.553575, 105.096846 29.5488, 105.100925 29.542798, 105.101866 29.538023, 105.099984 29.532157, 105.097474 29.526564, 105.094807 29.522608, 105.092768 29.518652, 105.091512 29.514286, 105.089944 29.51224, 105.086649 29.512785, 105.083826 29.51606, 105.081002 29.521244, 105.078178 29.526291, 105.075354 29.529429, 105.069864 29.538296, 105.056843 29.550437, 105.048685 29.551802, 105.039273 29.560942, 105.037547 29.56367, 105.03488 29.565989, 105.028449 29.567353, 105.021389 29.571173, 105.013389 29.576221, 105.010094 29.580586, 105.00978 29.58236, 105.010722 29.584542, 105.012761 29.591227, 105.013232 29.593682, 105.016055 29.596274, 105.016212 29.603914, 105.011506 29.610871, 105.013859 29.614418, 105.020448 29.614691, 105.023742 29.620421, 105.028135 29.622331, 105.03692 29.627787, 105.045548 29.628333, 105.064844 29.625741, 105.076139 29.624786, 105.081629 29.625741, 105.089473 29.625332, 105.102494 29.60787, 105.103435 29.601458, 105.109658 29.581114))";
		Connection conn=DBConnector.getInstance().getManConnection();
		SubtaskRefer bean=new SubtaskRefer();
		bean.setBlockId(623);
		bean.setGeometry(GeoTranslator.wkt2Geometry(wkt));
		SubtaskReferOperation.create(conn, bean);
		conn.commit();
		System.out.println("end"); 
	}
	
	@Test
	public void testType() throws Exception {
		System.out.println("start"); 
		Connection conn=DBConnector.getInstance().getManConnection();
		Block block = BlockService.getInstance().queryByBlockId(conn,643);
		Geometry referGeo = block.getGeometry();
		System.out.println(referGeo.getGeometryType()); 
	}
	
	
	
	@Test
	public void testUpdateBlockOrginGeo() throws Exception {
		System.out.println("start"); 
		String wkt="POLYGON ((105.109658 29.581114, 105.309453 29.57779, 105.310766 29.57774, 105.313796 29.576669, 105.315327 29.576607, 105.316107 29.576772, 105.317217 29.577453, 105.317676 29.578181, 105.317611 29.57965, 105.317408 29.580681, 105.316605 29.584834, 105.315764 29.587416, 105.314799 29.589046, 105.314111 29.595352, 105.313694 29.598503, 105.31374 29.600078, 105.314858 29.600619, 105.315577 29.600277, 105.316104 29.600107, 105.316633 29.600055, 105.317222 29.599944, 105.317688 29.600001, 105.318078 29.600063, 105.318477 29.600177, 105.318806 29.60041, 105.319128 29.600698, 105.319586 29.601218, 105.319847 29.601791, 105.320107 29.602307, 105.320298 29.602998, 105.320429 29.603514, 105.320429 29.604259, 105.320291 29.605175, 105.320482 29.606437, 105.320674 29.607699, 105.320804 29.608503, 105.321064 29.608964, 105.321324 29.609309, 105.321524 29.609423, 105.321853 29.60954, 105.322243 29.609599, 105.322641 29.609659, 105.32297 29.609548, 105.323299 29.609375, 105.323827 29.609091, 105.324355 29.608693, 105.324814 29.608409, 105.325343 29.607952, 105.32607 29.607613, 105.326728 29.607273, 105.327715 29.60682, 105.32884 29.606082, 105.329368 29.605681, 105.329567 29.605226, 105.329766 29.604768, 105.329835 29.604193, 105.329835 29.603677, 105.329773 29.603048, 105.329712 29.602531, 105.329582 29.602015, 105.329261 29.601325, 105.328733 29.600462, 105.328143 29.600001, 105.327753 29.599712, 105.327424 29.599538, 105.326835 29.599247, 105.325846 29.598785, 105.325127 29.598379, 105.324737 29.598091, 105.324538 29.597688, 105.324408 29.597457, 105.324347 29.596998, 105.324347 29.596713, 105.324416 29.596426, 105.324615 29.596198, 105.325074 29.59597, 105.325334 29.595917, 105.325732 29.595803, 105.326122 29.595806, 105.32678 29.595808, 105.327377 29.595984, 105.328166 29.596217, 105.329016 29.59645, 105.330133 29.596686, 105.33086 29.596805, 105.331319 29.596692, 105.331778 29.59658, 105.331847 29.596235, 105.331915 29.595952, 105.331915 29.595607, 105.331854 29.595148, 105.331854 29.594459, 105.331862 29.593828, 105.331932 29.593142, 105.33213 29.592684, 105.33239 29.592226, 105.332727 29.591828, 105.333148 29.591473, 105.333585 29.591257, 105.333914 29.59126, 105.334304 29.59132, 105.334633 29.591493, 105.334832 29.591667, 105.335092 29.591954, 105.335352 29.592298, 105.335681 29.592589, 105.335681 29.59276, 105.335673 29.593217, 105.335536 29.594537, 105.335406 29.595567, 105.335658 29.596428, 105.335858 29.597173, 105.336049 29.597805, 105.33631 29.598266, 105.336639 29.598727, 105.337427 29.599532, 105.337878 29.599937, 105.338476 29.600343, 105.339126 29.60069, 105.340113 29.601267, 105.341031 29.601902, 105.341621 29.602478, 105.34195 29.602881, 105.342141 29.603341, 105.342202 29.603685, 105.342202 29.60403, 105.342004 29.604371, 105.341805 29.604603, 105.341146 29.604998, 105.339891 29.605795, 105.336991 29.60704, 105.336593 29.607439, 105.336394 29.607841, 105.336394 29.60807, 105.336593 29.608302, 105.336853 29.608531, 105.337182 29.608648, 105.33758 29.60882, 105.33797 29.608879, 105.338231 29.608826, 105.338698 29.608883, 105.339157 29.608772, 105.339746 29.608658, 105.340275 29.608548, 105.341131 29.608382, 105.34192 29.608441, 105.342249 29.608559, 105.342708 29.608733, 105.343037 29.60902, 105.343229 29.609309, 105.343358 29.609825, 105.343428 29.610228, 105.343489 29.611032, 105.343481 29.612804, 105.343665 29.615043, 105.343925 29.616364, 105.344377 29.61757, 105.344767 29.618432, 105.345226 29.619348, 105.345877 29.620156, 105.346535 29.620848, 105.347254 29.621598, 105.348035 29.62246, 105.349221 29.623441, 105.35046 29.62448, 105.352037 29.625462, 105.353743 29.626502, 105.355189 29.62731, 105.356323 29.62792, 105.357026 29.628295, 105.354731 29.638958, 105.359511 29.640386, 105.377051 29.640541, 105.376803 29.641746, 105.376864 29.642343, 105.377576 29.643302, 105.378305 29.643764, 105.378604 29.643881, 105.380091 29.64447, 105.382472 29.645016, 105.383306 29.64549, 105.383963 29.645771, 105.384957 29.646194, 105.385951 29.646902, 105.387105 29.64761, 105.388099 29.648318, 105.389253 29.648739, 105.390246 29.649161, 105.390911 29.649584, 105.391407 29.650009, 105.391904 29.650295, 105.392233 29.650722, 105.392401 29.651149, 105.391801 29.653341, 105.390789 29.65807, 105.390728 29.65897, 105.390502 29.659883, 105.389643 29.661618, 105.388814 29.662434, 105.386544 29.663579, 105.38576 29.664149, 105.385558 29.664295, 105.385202 29.664776, 105.384615 29.666136, 105.384186 29.668886, 105.384278 29.670242, 105.384519 29.670911, 105.385371 29.672275, 105.3875 29.674675, 105.388884 29.676305, 105.389411 29.676546, 105.389701 29.676529, 105.39311 29.675058, 105.397743 29.672909, 105.400577 29.671606, 105.401092 29.671884, 105.406198 29.675258, 105.408393 29.677267, 105.408981 29.678556, 105.410302 29.680527, 105.411115 29.68142, 105.414672 29.684334, 105.41971 29.687974, 105.420656 29.688332, 105.421362 29.688395, 105.422739 29.688188, 105.423544 29.687859, 105.417035 29.717897, 105.403161 29.747586, 105.381447 29.796547, 105.367574 29.808006, 105.322937 29.81009, 105.282523 29.805923, 105.19687 29.826757, 105.157663 29.839779, 105.101566 29.8528, 105.088899 29.902282, 105.000834 29.973641, 104.967658 29.998642, 104.93733 29.946208, 104.886844 29.922673, 104.820463 29.906443, 104.786806 29.899139, 104.750344 29.929166, 104.703597 29.955946, 104.668069 29.947831, 104.651241 29.946208, 104.635347 29.950266, 104.600754 29.932412, 104.543723 29.933223, 104.530634 29.968931, 104.567097 29.990031, 104.542788 29.998146, 104.517545 30.00545, 104.508196 30.013565, 104.480148 30.010319, 104.46744 29.994865, 104.473603 29.96325, 104.498847 29.914558, 104.488562 29.839897, 104.495186 29.810718, 104.487627 29.794451, 104.462384 29.764992, 104.437609 29.751188, 104.413768 29.736166, 104.394134 29.745098, 104.384785 29.741038, 104.377773 29.741038, 104.371696 29.73373, 104.367021 29.73373, 104.361968 29.736807, 104.34692 29.73576, 104.332896 29.713023, 104.318405 29.696377, 104.299238 29.695971, 104.292226 29.692317, 104.278202 29.67161, 104.27119 29.657806, 104.267918 29.64522, 104.270804 29.627621, 104.275024 29.605122, 104.301279 29.58835, 104.323783 29.578533, 104.381876 29.597707, 104.391764 29.605531, 104.430678 29.594895, 104.503816 29.541717, 104.531523 29.493631, 104.549293 29.470949, 104.572266 29.453359, 104.578829 29.440269, 104.582691 29.429329, 104.602271 29.415725, 104.630402 29.412452, 104.659939 29.382181, 104.671408 29.367272, 104.677778 29.367491, 104.681885 29.370632, 104.685909 29.381518, 104.68901 29.384221, 104.694375 29.382906, 104.70326 29.371582, 104.712145 29.363619, 104.718097 29.363619, 104.721701 29.36435, 104.725613 29.36523, 104.72793 29.368394, 104.730863 29.371019, 104.732176 29.37425, 104.740243 29.38411, 104.744258 29.386971, 104.751824 29.389731, 104.742922 29.403493, 104.743625 29.419218, 104.753002 29.433717, 104.759097 29.446583, 104.775506 29.454344, 104.79392 29.453409, 104.825672 29.445358, 104.836973 29.440966, 104.849348 29.453731, 104.846806 29.465412, 104.849348 29.469252, 104.868735 29.467438, 104.885624 29.463768, 104.906736 29.45905, 104.907339 29.448564, 104.910355 29.440176, 104.919403 29.43703, 104.932673 29.439651, 104.941118 29.428641, 104.954388 29.421301, 104.985754 29.438078, 105.01531 29.441748, 105.032199 29.45171, 105.034613 29.464817, 105.047279 29.471633, 105.059343 29.453807, 105.075629 29.458001, 105.08528 29.441512, 105.065375 29.411278, 105.046978 29.388405, 105.04939 29.36711, 105.079248 29.334247, 105.134742 29.263526, 105.17033 29.243545, 105.194458 29.228297, 105.269856 29.192805, 105.291873 29.209894, 105.309667 29.25117, 105.339826 29.276934, 105.345859 29.285084, 105.358224 29.291394, 105.38024 29.292445, 105.407988 29.310849, 105.423308 29.315511, 105.422022 29.31673, 105.420786 29.318525, 105.420439 29.319429, 105.420435 29.320737, 105.42205 29.323262, 105.42284 29.325234, 105.423027 29.326242, 105.422969 29.327649, 105.422779 29.328496, 105.422336 29.330468, 105.42226 29.330675, 105.421196 29.333513, 105.420712 29.340664, 105.419636 29.34455, 105.419415 29.34691, 105.419407 29.351645, 105.419461 29.353651, 105.419869 29.354627, 105.421812 29.356728, 105.423311 29.35782, 105.426499 29.359778, 105.436921 29.366321, 105.437957 29.366882, 105.440091 29.367929, 105.441487 29.368943, 105.444707 29.372925, 105.445675 29.37416, 105.446067 29.375465, 105.445629 29.378269, 105.444978 29.382635, 105.444441 29.384803, 105.44374 29.38627, 105.443062 29.387241, 105.441461 29.389045, 105.440489 29.390565, 105.4398 29.392806, 105.439427 29.397325, 105.439697 29.400195, 105.439488 29.401073, 105.438618 29.402731, 105.437772 29.40372, 105.435787 29.405442, 105.434659 29.406915, 105.432115 29.413007, 105.431727 29.414048, 105.43072 29.416726, 105.429825 29.41763, 105.428978 29.417954, 105.428352 29.418021, 105.427192 29.417867, 105.425004 29.416245, 105.42254 29.415955, 105.421346 29.416091, 105.420453 29.416442, 105.418755 29.41756, 105.41737 29.418075, 105.416179 29.418072, 105.413775 29.417694, 105.41197 29.417532, 105.409833 29.418012, 105.409695 29.419153, 105.40923 29.4199, 105.40884 29.420299, 105.408443 29.420472, 105.408054 29.420642, 105.407198 29.42064, 105.407 29.421213, 105.406931 29.421785, 105.406992 29.422474, 105.407252 29.422991, 105.40752 29.423335, 105.408039 29.42391, 105.409672 29.425003, 105.41026 29.425692, 105.410062 29.425978, 105.409665 29.426207, 105.409009 29.426433, 105.408481 29.426662, 105.408481 29.426777, 105.408481 29.426947, 105.408611 29.42718, 105.40907 29.427411, 105.409459 29.427697, 105.410703 29.427986, 105.411031 29.428273, 105.411092 29.42856, 105.411092 29.428962, 105.410833 29.429306, 105.410505 29.42942, 105.410047 29.429417, 105.408864 29.42953, 105.408665 29.429815, 105.408597 29.430331, 105.408467 29.43056, 105.408268 29.430619, 105.408077 29.430731, 105.407749 29.430731, 105.407352 29.430672, 105.406703 29.430555, 105.406565 29.430784, 105.406436 29.431014, 105.406107 29.431416, 105.40545 29.431698, 105.404993 29.431698, 105.404465 29.43164, 105.402045 29.431115, 105.401387 29.431056, 105.401059 29.431229, 105.401059 29.4314, 105.401059 29.431801, 105.40112 29.432204, 105.401189 29.432832, 105.401052 29.433234, 105.400853 29.433633, 105.400463 29.433862, 105.399868 29.434262, 105.399211 29.43472, 105.398623 29.435289, 105.398424 29.435633, 105.398485 29.435748, 105.398615 29.435979, 105.398882 29.436152, 105.399142 29.436208, 105.399731 29.436269, 105.400448 29.436443, 105.400846 29.436672, 105.401166 29.437018, 105.401166 29.437132, 105.400968 29.437361, 105.40064 29.437647, 105.399784 29.438274, 105.399127 29.438732, 105.399127 29.438844, 105.399326 29.439191, 105.399455 29.439534, 105.399517 29.43988, 105.399517 29.440223, 105.399188 29.440566, 105.398791 29.440737, 105.398333 29.440907, 105.397676 29.441192, 105.397286 29.441477, 105.397018 29.441764, 105.397018 29.442508, 105.397011 29.442966, 105.397011 29.443426, 105.396943 29.443825, 105.396812 29.444169, 105.396484 29.444514, 105.396088 29.444799, 105.39556 29.445082, 105.394972 29.445252, 105.394712 29.445366, 105.394712 29.445481, 105.394773 29.445654, 105.394972 29.44571, 105.3953 29.445713, 105.395759 29.445713, 105.396416 29.445774, 105.396736 29.445774, 105.396874 29.445889, 105.396936 29.44612, 105.396936 29.446291, 105.396805 29.446519, 105.396469 29.446863, 105.395751 29.447262, 105.394696 29.447603, 105.394696 29.447832, 105.394696 29.448175, 105.394696 29.448462, 105.394628 29.448692, 105.394429 29.448921, 105.394101 29.449032, 105.393711 29.449146, 105.393122 29.449146, 105.392665 29.449258, 105.392359 29.449426, 105.391939 29.449657, 105.391343 29.450458, 105.390884 29.451086, 105.390686 29.451659, 105.385424 29.451991, 105.378593 29.450832, 105.373956 29.450042, 105.368667 29.448774, 105.366158 29.447745, 105.363572 29.445779, 105.360026 29.4437, 105.357457 29.443788, 105.353836 29.442186, 105.351082 29.442008, 105.349689 29.44209, 105.347654 29.442472, 105.34661 29.442932, 105.34478 29.444254, 105.343281 29.445065, 105.340598 29.445772, 105.339224 29.445968, 105.336373 29.446059, 105.334973 29.445858, 105.331938 29.444904, 105.330017 29.444271, 105.329102 29.444285, 105.32841 29.444635, 105.327242 29.445763, 105.32634 29.446595, 105.32308 29.454759, 105.326184 29.458472, 105.327637 29.459866, 105.330902 29.462298, 105.331686 29.462624, 105.333546 29.462847, 105.334771 29.463307, 105.335008 29.463672, 105.334839 29.46449, 105.332334 29.46663, 105.330149 29.468151, 105.329403 29.468315, 105.327688 29.46796, 105.326853 29.46792, 105.326475 29.468039, 105.325564 29.468589, 105.32416 29.470067, 105.322691 29.473894, 105.321508 29.475319, 105.320762 29.47592, 105.31984 29.476402, 105.317801 29.477005, 105.316319 29.477615, 105.315581 29.47812, 105.315421 29.478458, 105.315619 29.480315, 105.316148 29.483411, 105.315945 29.484091, 105.31467 29.485212, 105.312608 29.485495, 105.311246 29.486592, 105.310936 29.487296, 105.311205 29.490449, 105.310899 29.495573, 105.310482 29.497304, 105.309881 29.499792, 105.310004 29.500364, 105.310788 29.501424, 105.312598 29.502719, 105.313509 29.50311, 105.315479 29.503659, 105.316792 29.504404, 105.317247 29.505361, 105.317803 29.508008, 105.317645 29.5093, 105.317141 29.510467, 105.315595 29.512622, 105.310196 29.518141, 105.308206 29.521009, 105.307866 29.521917, 105.307648 29.52387, 105.307185 29.525291, 105.306382 29.526149, 105.305835 29.526418, 105.302162 29.527205, 105.299053 29.528119, 105.297526 29.528729, 105.296421 29.529471, 105.295786 29.529894, 105.295116 29.530647, 105.294443 29.531938, 105.294321 29.534978, 105.294086 29.546551, 105.290929 29.548476, 105.290861 29.549391, 105.290723 29.550424, 105.290326 29.551169, 105.290088 29.551733, 105.289997 29.551967, 105.289791 29.552656, 105.289859 29.553112, 105.289989 29.553343, 105.290181 29.553517, 105.290578 29.553748, 105.290969 29.553691, 105.291565 29.55335, 105.292023 29.553125, 105.292421 29.553069, 105.29262 29.553128, 105.292812 29.553243, 105.292881 29.553416, 105.292812 29.553586, 105.292812 29.553874, 105.292743 29.554275, 105.292743 29.554793, 105.292873 29.555077, 105.293064 29.555309, 105.293332 29.555365, 105.293592 29.555368, 105.293852 29.555371, 105.294318 29.555257, 105.294579 29.555316, 105.294708 29.555433, 105.294908 29.555604, 105.295038 29.555777, 105.295099 29.556235, 105.29503 29.556581, 105.29503 29.55681, 105.2949 29.557036, 105.294763 29.557267, 105.294434 29.558066, 105.294105 29.558524, 105.293837 29.559039, 105.293638 29.559554, 105.293439 29.560183, 105.293431 29.560812, 105.293493 29.561273, 105.293692 29.561675, 105.294801 29.562885, 105.29526 29.563516, 105.29552 29.563918, 105.29565 29.564377, 105.295712 29.564781, 105.295841 29.565125, 105.295841 29.565582, 105.295971 29.566044, 105.296163 29.566331, 105.296293 29.566558, 105.296561 29.566792, 105.296752 29.566965, 105.296951 29.567137, 105.296522 29.570517, 105.296787 29.571214, 105.297074 29.571502, 105.29868 29.572522, 105.308829 29.577629, 105.309453 29.57779, 105.109658 29.581114, 105.111906 29.573765, 105.108141 29.562033, 105.104219 29.556713, 105.09716 29.553575, 105.096846 29.5488, 105.100925 29.542798, 105.101866 29.538023, 105.099984 29.532157, 105.097474 29.526564, 105.094807 29.522608, 105.092768 29.518652, 105.091512 29.514286, 105.089944 29.51224, 105.086649 29.512785, 105.083826 29.51606, 105.081002 29.521244, 105.078178 29.526291, 105.075354 29.529429, 105.069864 29.538296, 105.056843 29.550437, 105.048685 29.551802, 105.039273 29.560942, 105.037547 29.56367, 105.03488 29.565989, 105.028449 29.567353, 105.021389 29.571173, 105.013389 29.576221, 105.010094 29.580586, 105.00978 29.58236, 105.010722 29.584542, 105.012761 29.591227, 105.013232 29.593682, 105.016055 29.596274, 105.016212 29.603914, 105.011506 29.610871, 105.013859 29.614418, 105.020448 29.614691, 105.023742 29.620421, 105.028135 29.622331, 105.03692 29.627787, 105.045548 29.628333, 105.064844 29.625741, 105.076139 29.624786, 105.081629 29.625741, 105.089473 29.625332, 105.102494 29.60787, 105.103435 29.601458, 105.109658 29.581114))";
		List<Object> values = new ArrayList<Object>();
		Connection conn=DBConnector.getInstance().getManConnection();
		String createSql="update block set origin_geo=? where block_id=999";
		STRUCT struct = GeoTranslator.wkt2Struct(conn,  wkt);
		values.add(struct);
		QueryRunner run = new QueryRunner();
		run.update(conn, 
				   createSql, 
				   values.toArray() );
		conn.commit();
		System.out.println("end"); 
	}
	
//	public static void main(String[] args) throws Exception{
//		System.out.println("start"); 
//		commonTest test=new commonTest();
//		test.before();
//		
//		String sql="insert into subtask_quality(quality_id,subtask_id,geometry)"
//		+ "select subtask_quality_seq.nextval,142,sdo_geometry('POLYGON ((114.56434 39.36486，114.56434 40.21208，116.79367 40.21208，116.79367 39.36486，114.56434 39.36486))',"
//		+ "8307) from dual";
//		//String filePathString="D:/temp/block_tab2json/bj.TAB";
//		//String filePathString = String.valueOf(args[0]);
//		Connection conn=DBConnector.getInstance().getManConnection();
//		QueryRunner runner=new QueryRunner();
//		runner.update(conn, sql);
//		//List<Map<String, Object>> dataList = LoadTab.readTabReturnAllData(filePathString);
//		//ImportOracle.writeOracle(conn, "test1125", dataList);
//		DbUtils.commitAndCloseQuietly(conn);
//		System.out.println("end"); 
//	}

}
