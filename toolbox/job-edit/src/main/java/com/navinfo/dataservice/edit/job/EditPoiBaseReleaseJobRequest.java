package com.navinfo.dataservice.edit.job;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import net.sf.json.JSONArray;

import com.navinfo.dataservice.jobframework.exception.JobCreateException;
import com.navinfo.dataservice.jobframework.exception.JobException;
import com.navinfo.dataservice.jobframework.runjob.AbstractJobRequest;
import com.navinfo.dataservice.jobframework.runjob.JobCreateStrategy;

public class EditPoiBaseReleaseJobRequest extends AbstractJobRequest {
	private List<Integer> gridIds;
	private int targetDbId;
	private List<String> checkRules;
	private List<String> batchRules;


	@Override
	public String getJobType() {
		return "editPoiBaseRelease";
	}

	@Override
	public void validate() throws JobException {
		// TODO Auto-generated method stub
		
	}

	public List<Integer> getGridIds() {
		return gridIds;
	}

	public void setGridIds(List<Integer> gridIds) {
		this.gridIds = gridIds;
	}

	public int getTargetDbId() {
		return targetDbId;
	}

	public void setTargetDbId(int targetDbId) {
		this.targetDbId = targetDbId;
	}

	public List<String> getCheckRules() {
		return checkRules;
	}

	public void setCheckRules(List<String> checkRules) {
		this.checkRules = checkRules;
	}

	public List<String> getBatchRules() {
		return batchRules;
	}

	public void setBatchRules(List<String> batchRules) {
		this.batchRules = batchRules;
	}

	@Override
	public void defineSubJobRequests() throws JobCreateException {
		subJobRequests = new HashMap<String,AbstractJobRequest>();
		//validation
		List<String> checkRule=new ArrayList<String>();
		String rulestr = "GLM51102,GLM04007,GLM04006,GLM04001,GLM05097,GLM05098,GLM04003,GLM04002,GLM05087,GLM05088,GLM05085,GLM05086,GLM05089,GLM05090,GLM05095,GLM05094,GLM01340,GLM08037,GLM08038,GLM08039,GLM01343,GLM08033,GLM01348,GLM08034,GLM01349,GLM08035,GLM08036,GLM08041,GLM08040,GLM08043,GLM08042,GLM01353,GLM08048,GLM01356,GLM08049,GLM01357,GLM08046,GLM01358,GLM08047,GLM01359,GLM08044,GLM08045,GLM04011,GLM08054,GLM08053,GLM08052,GLM08051,GLM08050,GLM14010,GLM51106,GLM51105,GLM51104,GLM51103,GLM51109,GLM51108,GLM51107,GLM01306,GLM01307,GLM14006,GLM14005,GLM14004,GLM14003,GLM14009,GLM14008,GLM14007,GLM14002,GLM51101,GLM14001,GLM51100,GLM51114,GLM51110,GLM51111,GLM51112,GLM51113,GLM50310,GLM50314,GLM50311,GLM50312,GLM50317,GLM50318,GLM50315,GLM56033,GLM56032,GLM56030,GLM56035,GLM56034,GLM56039,GLM02038,GLM56040,GLM56041,GLM56011,GLM56010,GLM56019,GLM56018,GLM56017,GLM56016,GLM56015,GLM56014,GLM56013,GLM56012,GLM02013,GLM02015,GLM02019,GLM23011,GLM23010,GLM02012,GLM02011,GLM56020,GLM56021,GLM56028,GLM56027,GLM23009,GLM56024,GLM56023,GLM56026,GLM56025,GLM23006,GLM23005,GLM23007,GLM23002,GLM23001,GLM23004,GLM23003,GLM02021,GLM02080,GLM02075,GLM02076,GLM02078,GLM02074,GLM03999,GLM02079,GLM02091,GLM02090,GLM02088,GLM02089,GLM02086,GLM02087,GLM02084,GLM02085,GLM02053,GLM02054,GLM02056,GLM02058,GLM02062,GLM02066,GLM05070,GLM05071,GLM05072,GLM05073,GLM05080,GLM05083,GLM05084,GLM05082,GLM05077,GLM05076,GLM05075,GLM05074,GLM05079,GLM05050,GLM02096,GLM02095,GLM02094,GLM02093,GLM02099,GLM05049,GLM05046,GLM05048,GLM05042,GLM05041,GLM05044,GLM05043,GLM05056,GLM05055,GLM05054,GLM05053,GLM05020,GLM05021,GLM05022,GLM05023,GLM70010,GLM05024,GLM05025,GLM05026,GLM05027,GLM05028,GLM05029,GLM56009,GLM56003,GLM05032,GLM56004,GLM05033,GLM56001,GLM05031,GLM56007,GLM05036,GLM05037,GLM56008,GLM56005,GLM05035,GLM05001,GLM05002,GLM05003,GLM05004,GLM05009,GLM01290,GLM01291,GLM01296,GLM01297,GLM01295,GLM05008,GLM16006,GLM16005,GLM16008,GLM16007,GLM16009,GLM70009,GLM70006,GLM70005,GLM70008,GLM70007,GLM16002,GLM70002,GLM70001,GLM16004,GLM70004,GLM16003,GLM70003,GLM01287,GLM05015,GLM01288,GLM05012,GLM05013,GLM05010,GLM05011,GLM01280,GLM01281,GLM01282,GLM05018,GLM01283,GLM01284,GLM05019,GLM05017,GLM01260,GLM15010,GLM01264,GLM15013,GLM01263,GLM15011,GLM01262,GLM15012,GLM01261,GLM01268,GLM01267,GLM01266,GLM53090,GLM01265,GLM01269,GLM53086,GLM53088,GLM53089,GLM01270,GLM15001,GLM01272,GLM01275,GLM15003,GLM01277,GLM15004,GLM01276,GLM15005,GLM53080,GLM01279,GLM15006,GLM01278,GLM15007,GLM53081,GLM15008,GLM15009,GLM53084,GLM53085,GLM01242,GLM01241,GLM53079,GLM01240,GLM53077,GLM53078,GLM53075,GLM53076,GLM01249,GLM01248,GLM53071,GLM01247,GLM53072,GLM01246,GLM01245,GLM53070,GLM01244,GLM01243,GLM01251,GLM53068,GLM01250,GLM53069,GLM01252,GLM53064,GLM53065,GLM53066,GLM53067,GLM53060,GLM01259,GLM53061,GLM01258,GLM53062,GLM53063,GLM01255,GLM01254,GLM01257,GLM01256,GLM01221,GLM53052,GLM53051,GLM53050,GLM53056,GLM53055,GLM53054,GLM53053,GLM53059,GLM53058,GLM53057,GLM17001,GLM17004,GLM17005,GLM17002,GLM17003,GLM17008,GLM17006,GLM17007,GLM01232,GLM01234,GLM01235,GLM01236,GLM01237,GLM01238,GLM01239,GLM53040,GLM53043,GLM53044,GLM53047,GLM01230,GLM53049,GLM01231,GLM53048,GLM17012,GLM17013,GLM17014,GLM17015,GLM17016,GLM17018,GLM53030,GLM01205,GLM01206,GLM01203,GLM01204,GLM01201,GLM53038,GLM53037,GLM29170,GLM53034,GLM53031,GLM29165,GLM29166,GLM29167,GLM29168,GLM53039,GLM01209,GLM01208,GLM01207,GLM01214,GLM34004,GLM34002,GLM34001,GLM01210,GLM01211,GLM01212,GLM34006,GLM01213,GLM34005,GLM53024,GLM53027,GLM53026,GLM53021,GLM53020,GLM53022,GLM53029,GLM32110,GLM32111,GLM32112,GLM32113,GLM32114,GLM32115,GLM32116,GLM32117,GLM32119,GLM32121,GLM32104,GLM32105,GLM32102,GLM32103,GLM32109,GLM32108,GLM32107,GLM32106,GLM02004,GLM02007,GLM02008,GLM50200,GLM50201,GLM50202,GLM50203,GLM12011,GLM12010,GLM12017,GLM19028,GLM12016,GLM19026,GLM12019,GLM12018,GLM19024,GLM12012,GLM19025,GLM19022,GLM12014,GLM19023,GLM19032,GLM20035,GLM20034,GLM12022,GLM12021,GLM12020,GLM12029,GLM12028,GLM12027,GLM12026,GLM19033,GLM12025,GLM19034,GLM12024,GLM19035,GLM19036,GLM18010,GLM18011,GLM18012,GLM18013,GLM18014,GLM18015,GLM19009,GLM12031,GLM12030,GLM12033,GLM12032,GLM50109,GLM19002,GLM50108,GLM19003,GLM50107,GLM12037,GLM12036,GLM50106,GLM19001,GLM19006,GLM50105,GLM50104,GLM12038,GLM19007,GLM19004,GLM50102,GLM19005,GLM50100,GLM29109,GLM50101,GLM29107,GLM29106,GLM18009,GLM18007,GLM18008,GLM18005,GLM29100,GLM18003,GLM18004,GLM18001,GLM29105,GLM54051,GLM18002,GLM29104,GLM29103,GLM29102,GLM12040,GLM12044,GLM12043,GLM12042,GLM12047,GLM19013,GLM19014,GLM12045,GLM12049,GLM29118,GLM29117,GLM29119,GLM19021,GLM29110,GLM29112,GLM29111,GLM29114,GLM29113,GLM29116,GLM29115,GLM50126,GLM50127,GLM50124,GLM50125,GLM29130,GLM29126,GLM29127,GLM29125,GLM29122,GLM29123,GLM29120,GLM29121,GLM50123,GLM50122,GLM50121,GLM29128,GLM50120,GLM29129,GLM50113,GLM50114,GLM50115,GLM50116,GLM50117,GLM50118,GLM50119,GLM29141,GLM29140,GLM20009,GLM20008,GLM20002,GLM29136,GLM20004,GLM29137,GLM20005,GLM29138,GLM29131,GLM29132,GLM20001,GLM29134,GLM50110,GLM29139,GLM50112,GLM50111,GLM19045,GLM29152,GLM29144,GLM29142,GLM20010,GLM29143,GLM29148,GLM20016,GLM29149,GLM20014,GLM29147,GLM12003,GLM12004,GLM12001,GLM12002,GLM12007,GLM12005,GLM12006,GLM29163,GLM29162,GLM29153,GLM29154,GLM12009,GLM01119,GLM02999,GLM01110,GLM01114,GLM01113,GLM01112,GLM01118,GLM01117,GLM01116,GLM01115,GLM01108,GLM01109,GLM30011,GLM30014,GLM30015,GLM30012,GLM30019,GLM01101,GLM01100,GLM01103,GLM01102,GLM01105,GLM01104,GLM01106,GLM30003,GLM30004,GLM30009,GLM30006,GLM30005,GLM30007,GLM11098,GLM11095,GLM11094,GLM11091,GLM01157,GLM01155,GLM01156,GLM01159,GLM01150,GLM01154,GLM01151,GLM01152,GLM36001,GLM36002,GLM02130,GLM11088,GLM02131,GLM02132,GLM36007,GLM36008,GLM36003,GLM11080,GLM36004,GLM36005,GLM36006,GLM01144,GLM01145,GLM11090,GLM01146,GLM01147,GLM01148,GLM01149,GLM01140,GLM01142,GLM01143,GLM53004,GLM53005,GLM53002,GLM53001,GLM50997,GLM01139,GLM50998,GLM50999,GLM01137,GLM01138,GLM53009,GLM01135,GLM53008,GLM01136,GLM53007,GLM01133,GLM53006,GLM01134,GLM01131,GLM01132,GLM01130,GLM02154,GLM53014,GLM53016,GLM53010,GLM53011,GLM53012,GLM01126,GLM01127,GLM01128,GLM01129,GLM01122,GLM01123,GLM53019,GLM01125,GLM01120,GLM01121,GLM32097,GLM28050,GLM52026,GLM01187,GLM32096,GLM01186,GLM52024,GLM28052,GLM01185,GLM32095,GLM52023,GLM28051,GLM01184,GLM32094,GLM01183,GLM52022,GLM32093,GLM52021,GLM32092,GLM01181,GLM32091,GLM32090,GLM01180,GLM01189,GLM01188,GLM32098,GLM11041,GLM11040,GLM28046,GLM01190,GLM28047,GLM01566,GLM01567,GLM52029,GLM28042,GLM01565,GLM28043,GLM11049,GLM52027,GLM52028,GLM11048,GLM28045,GLM01563,GLM01196,GLM28041,GLM28040,GLM01195,GLM52015,GLM01198,GLM52014,GLM01197,GLM01192,GLM01191,GLM52011,GLM01194,GLM52010,GLM01193,GLM01199,GLM01570,GLM28039,GLM28037,GLM01577,GLM28038,GLM01578,GLM28035,GLM01579,GLM28036,GLM28033,GLM52016,GLM52017,GLM11059,GLM28034,GLM01574,GLM01575,GLM52018,GLM28031,GLM28032,GLM01576,GLM52043,GLM01160,GLM52042,GLM52041,GLM52048,GLM52047,GLM09021,GLM01169,GLM01167,GLM01166,GLM52040,GLM02115,GLM02118,GLM11060,GLM02117,GLM02116,GLM01581,GLM28064,GLM09012,GLM09013,GLM28065,GLM28066,GLM09014,GLM52049,GLM28067,GLM09015,GLM28068,GLM09016,GLM28069,GLM09017,GLM09018,GLM09019,GLM01170,GLM52031,GLM52033,GLM52032,GLM52035,GLM09011,GLM01174,GLM28063,GLM01173,GLM52034,GLM09010,GLM28062,GLM01176,GLM01175,GLM28060,GLM01178,GLM01179,GLM11074,GLM11073,GLM09009,GLM11076,GLM11075,GLM11072,GLM02129,GLM11071,GLM36011,GLM28055,GLM09003,GLM52038,GLM52039,GLM28056,GLM09004,GLM28053,GLM36013,GLM36012,GLM28059,GLM09007,GLM11077,GLM09005,GLM28057,GLM09006,GLM11079,GLM28058,GLM32058,GLM80005,GLM32059,GLM32056,GLM32057,GLM80001,GLM32055,GLM32052,GLM32053,GLM32050,GLM11008,GLM32051,GLM28003,GLM11002,GLM28002,GLM04009,GLM04008,GLM04005,GLM04004,GLM50303,GLM50302,GLM50301,GLM50307,GLM22009,GLM50306,GLM50305,GLM50304,GLM50309,GLM50308,GLM57039,GLM57035,GLM57038,GLM57037,GLM22004,GLM57032,GLM57031,GLM57034,GLM22006,GLM57033,GLM22007,GLM57030,GLM22002,GLM22003,GLM57029,GLM57028,GLM57026,GLM57025,GLM57024,GLM57023,GLM57022,GLM57020,GLM05102,GLM05101,GLM05107,GLM05106,GLM05105,GLM05104,GLM57041,GLM57040,GLM57043,GLM57042,GLM03070,GLM03071,GLM03069,GLM03064,GLM03062,GLM03061,GLM03068,GLM03067,GLM03066,GLM03065,GLM03080,GLM03081,GLM03082,GLM03073,GLM03072,GLM03077,GLM03079,GLM03078,GLM03092,GLM03093,GLM03090,GLM03091,GLM57010,GLM57013,GLM03089,GLM57016,GLM03087,GLM03086,GLM57018,GLM03085,GLM57019,GLM03084,GLM03083,GLM57001,GLM57004,GLM57002,GLM57008,GLM03094,GLM57009,GLM03097,GLM57007,GLM07006,GLM07005,GLM07004,GLM07003,GLM07001,GLM07007,GLM26999,GLM03038,GLM03039,GLM03045,GLM03046,GLM03041,GLM03042,GLM03047,GLM03048,GLM03056,GLM03054,GLM03055,GLM03053,GLM03050,GLM03058,GLM03059,GLM51096,GLM51095,GLM51098,GLM51097,GLM51099,GLM51090,GLM51092,GLM51091,GLM51094,GLM51093,GLM51086,GLM51084,GLM51089,GLM51088,GLM51083,GLM51082,GLM51080,GLM03003,GLM03001,GLM22012,GLM22011,GLM22010,GLM08012,GLM08011,GLM08014,GLM01369,GLM01368,GLM08013,GLM08016,GLM01367,GLM08015,GLM01366,GLM01365,GLM08017,GLM01364,GLM01363,GLM01362,GLM08025,GLM08024,GLM01379,GLM08023,GLM08022,GLM01376,GLM08028,GLM01375,GLM01378,GLM08027,GLM01377,GLM01372,GLM08031,GLM08032,GLM08030,GLM01389,GLM01388,GLM01387,GLM01386,GLM01381,GLM01380,GLM01385,GLM01384,GLM01383,GLM01382,GLM01398,GLM08006,GLM08005,GLM08004,GLM01399,GLM08003,GLM08002,GLM08001,GLM01390,GLM01392,GLM01391,GLM01394,GLM01393,GLM01396,GLM08009,GLM01395,GLM08010,GLM11003,GLM28005,GLM28004,GLM11006,GLM11007,GLM28001,GLM11004,GLM11005,GLM28007,GLM28006,GLM28009,GLM28008,GLM32069,GLM32065,GLM32066,GLM32061,GLM28999,GLM32062,GLM32063,GLM32064,GLM32060,GLM11015,GLM11016,GLM32076,GLM80029,GLM32070,GLM32071,GLM52003,GLM32074,GLM32075,GLM52004,GLM52001,GLM32072,GLM32073,GLM28030,GLM52002,GLM11028,GLM28021,GLM52008,GLM11029,GLM52007,GLM11026,GLM28023,GLM52006,GLM11027,GLM52005,GLM28025,GLM11024,GLM11025,GLM28024,GLM28026,GLM52009,GLM28029,GLM28028,GLM32080,GLM28012,GLM11037,GLM28011,GLM11038,GLM11039,GLM28010,GLM28016,GLM11034,GLM28015,GLM28013,GLM11036,GLM11030,GLM28019,GLM28018,GLM28017,GLM32018,GLM32019,GLM29057,GLM29056,GLM29055,GLM29054,GLM29059,GLM29058,GLM29060,GLM29063,GLM29064,GLM29061,GLM29062,GLM32011,GLM32013,GLM32029,GLM29044,GLM29043,GLM29045,GLM29048,GLM29047,GLM29049,GLM32020,GLM29050,GLM29052,GLM32028,GLM32025,GLM32021,GLM29079,GLM29078,GLM29085,GLM01505,GLM29086,GLM29083,GLM29084,GLM29082,GLM32032,GLM32035,GLM32036,GLM32038,GLM01513,GLM01514,GLM01517,GLM01516,GLM01515,GLM32040,GLM01519,GLM32045,GLM32044,GLM32043,GLM32049,GLM01522,GLM29098,GLM01525,GLM29099,GLM01524,GLM01521,GLM01520,GLM06005,GLM06007,GLM06006,GLM06008,GLM01526,GLM01527,GLM01528,GLM01529,GLM01536,GLM29087,GLM29088,GLM29089,GLM01534,GLM01533,GLM01532,GLM01531,GLM01530,GLM29091,GLM29090,GLM12051,GLM29093,GLM29092,GLM29095,GLM01539,GLM12054,GLM29094,GLM12052,GLM29097,GLM12053,GLM01541,GLM01540,GLM01543,GLM01542,GLM01544,GLM01547,GLM01546,GLM01548,GLM01549,GLM01557,GLM32008,GLM32007,GLM32001,GLM32002,GLM32005,GLM32006,GLM32004,GLM90051,GLM37006,GLM29030,GLM37008,GLM37009,GLM50029,GLM50027,GLM37003,GLM50025,GLM37001,GLM50026,GLM50023,GLM29029,GLM50022,GLM50021,GLM50020,GLM29023,GLM29021,GLM29022,GLM29028,GLM29025,GLM29026,GLM37015,GLM29040,GLM29042,GLM29041,GLM50018,GLM50019,GLM37011,GLM50014,GLM37012,GLM50015,GLM37013,GLM37014,GLM50010,GLM50013,GLM50012,GLM29032,GLM29033,GLM50005,GLM26051,GLM26052,GLM50006,GLM50003,GLM50004,GLM50009,GLM21011,GLM50007,GLM21012,GLM50008,GLM50002,GLM50001,GLM29007,GLM29008,GLM29005,GLM29006,GLM29003,GLM29020,GLM21003,GLM21004,GLM21002,GLM29018,GLM29019,GLM21008,GLM21007,GLM29014,GLM29016,GLM29017,GLM29010,GLM29011,GLM29012,GLM29013,GLM13025,GLM13024,GLM13027,GLM50060,GLM13026,GLM13029,GLM13028,GLM50065,GLM50067,GLM50068,GLM50061,GLM13021,GLM50062,GLM13020,GLM13023,GLM50063,GLM13022,GLM50064,GLM26033,GLM26032,GLM26039,GLM13037,GLM13035,GLM50056,GLM13030,GLM50057,GLM50054,GLM50055,GLM26050,GLM50052,GLM13034,GLM13033,GLM50050,GLM13032,GLM50051,GLM13031,GLM26045,GLM26044,GLM26047,GLM26046,GLM26041,GLM26040,GLM26043,GLM26042,GLM26049,GLM26048,GLM50040,GLM50041,GLM50042,GLM50044,GLM50045,GLM26010,GLM50047,GLM50049,GLM26014,GLM26013,GLM26012,GLM26011,GLM26017,GLM50034,GLM50033,GLM50039,GLM50038,GLM01010,GLM52074,GLM01018,GLM52072,GLM52073,GLM52070,GLM01017,GLM52071,GLM01014,GLM01015,GLM01012,GLM01013,GLM50099,GLM50098,GLM50097,GLM50095,GLM50094,GLM50093,GLM50092,GLM02271,GLM26008,GLM26009,GLM26004,GLM26005,GLM26006,GLM26007,GLM01005,GLM01006,GLM26002,GLM01007,GLM26003,GLM01008,GLM01003,GLM01004,GLM50086,GLM50088,GLM50087,GLM02264,GLM50080,GLM02265,GLM50082,GLM02263,GLM52054,GLM52055,GLM52052,GLM52053,GLM01032,GLM01033,GLM52059,GLM52056,GLM52057,GLM01031,GLM52050,GLM01038,GLM01039,GLM50075,GLM02255,GLM02256,GLM02257,GLM02258,GLM50072,GLM02259,GLM50077,GLM52998,GLM02251,GLM52999,GLM52064,GLM52065,GLM01020,GLM01021,GLM01023,GLM01025,GLM01026,GLM01027,GLM01028,GLM52060,GLM01040,GLM91020,GLM91021,GLM01043,GLM01042,GLM01041,GLM01465,GLM91027,GLM91026,GLM91029,GLM01463,GLM91028,GLM01464,GLM01469,GLM02232,GLM91023,GLM02231,GLM91022,GLM02230,GLM91025,GLM01467,GLM01468,GLM91024,GLM02236,GLM02235,GLM02234,GLM02233,GLM01461,GLM01462,GLM02239,GLM02238,GLM01460,GLM02237,GLM91031,GLM91032,GLM02240,GLM02243,GLM91033,GLM02245,GLM02244,GLM01470,GLM01471,GLM02248,GLM01069,GLM02219,GLM01068,GLM01067,GLM01066,GLM01065,GLM01064,GLM01449,GLM02210,GLM01447,GLM01448,GLM01445,GLM01446,GLM01444,GLM01441,GLM01442,GLM02218,GLM02213,GLM02211,GLM01070,GLM91014,GLM01456,GLM91013,GLM01457,GLM01458,GLM02220,GLM01459,GLM91018,GLM91017,GLM91016,GLM01454,GLM91015,GLM01455,GLM01450,GLM91019,GLM01451,GLM01083,GLM01084,GLM01081,GLM01082,GLM01087,GLM10018,GLM01088,GLM10019,GLM01085,GLM01086,GLM01089,GLM10014,GLM10017,GLM10016,GLM01091,GLM01090,GLM10013,GLM10012,GLM01092,GLM01093,GLM01094,GLM01095,GLM01096,GLM01097,GLM01098,GLM01099,GLM02209,GLM02208,GLM02202,GLM02205,GLM02206,GLM01483,GLM01482,GLM01480,GLM11120,GLM11124,GLM13016,GLM11122,GLM10009,GLM10007,GLM10008,GLM10002,GLM10001,GLM13002,GLM13003,GLM10006,GLM10003,GLM11104,GLM11103,GLM11106,GLM11105,GLM51037,GLM11100,GLM11102,GLM11101,GLM51031,GLM51030,GLM11107,GLM51036,GLM51033,GLM51027,GLM11116,GLM51029,GLM11115,GLM51028,GLM11114,GLM11112,GLM11111,GLM11110,GLM51022,GLM51023,GLM51024,GLM11118,GLM51025,GLM11119,GLM51019,GLM51018,GLM51017,GLM51016,GLM51015,GLM51013,GLM51011,GLM51012,GLM51010,GLM51009,GLM51008,GLM51005,GLM51004,GLM51007,GLM51006,GLM51001,GLM51002,GLM51003,GLM51075,GLM51073,GLM51078,GLM51077,GLM51072,GLM51071,GLM51070,GLM01432,GLM33001,GLM01431,GLM33002,GLM01430,GLM33003,GLM01437,GLM33004,GLM33005,GLM33006,GLM33007,GLM51063,GLM33009,GLM51062,GLM33008,GLM51065,GLM01438,GLM51064,GLM01439,GLM51067,GLM51069,GLM51068,GLM51061,GLM51060,GLM01401,GLM01404,GLM01403,GLM51059,GLM01400,GLM51058,GLM51057,GLM01405,GLM01406,GLM51052,GLM01407,GLM51051,GLM51050,GLM01413,GLM51048,GLM01411,GLM51047,GLM51046,GLM51041,GLM01418,GLM01419,GLM51043,GLM01416,GLM51042,GLM01417,GLM50319CHR99998,GLM01582,GLM05108,GLM29171,GLM29172,GLM32122,GLM32123,GLM01583";
		for(String r:rulestr.split(",")){
			checkRule.add(r);
		}
//		checkRule.add("GLM01004");
		this.setCheckRules(checkRule);
		AbstractJobRequest validation = JobCreateStrategy.createJobRequest("gdbValidation", null);
		validation.setAttrValue("grids", gridIds);
		validation.setAttrValue("rules", JSONArray.fromObject(this.checkRules));
		validation.setAttrValue("targetDbId", targetDbId);
		validation.setAttrValue("timeOut", 600);
		subJobRequests.put("validation", validation);
		//batch
		List<String> batchRule=new ArrayList<String>();
		batchRule.add("MILEAGEPILE_DIRECT");
		batchRule.add("BATCH_SLE");
		batchRule.add("BATCH_VECTOR_ATTR");
		batchRule.add("BATCH_LANE_PARKING_FLAG");
		batchRule.add("MILEAGEPILE_NAMECODE");
		
		this.setBatchRules(batchRule);
		AbstractJobRequest batch = JobCreateStrategy.createJobRequest("gdbBatch", null);
		batch.setAttrValue("grids", gridIds);
		batch.setAttrValue("rules", JSONArray.fromObject(this.batchRules));
		batch.setAttrValue("targetDbId", targetDbId);
		subJobRequests.put("batch", batch);
	}

	@Override
	protected int myStepCount() throws JobException {
		return 1;
	}

}
